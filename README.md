# Предлагаю скачать обновлёную и улучщеную версию GuiCronManager_09.tcl 

в которой организована правильная работа задач в crontab, а точнее каждой задаче присваевается свой уникальный UID, и это убирает конфликт имен задач в crontab. В приведеной ранее версии GuiCronManager_07.tcl есть баг , возникает конфликт имен и потому сбрасывается crontab, я пофиксил это. 

# GuiCronMan
GuiCronMan--The minimalist manager of Cron TCL/TK tasks is a graphic application for managing the planned tasks in UNIX -like systems.

# Минималистичный менеджер Cron задач на Tcl/Tk

![Cron Manager](https://github.com/totiks2012/GuiCronMan/blob/main/cron_manager_screenshot.png)

## Описание

Минималистичный менеджер Cron задач на Tcl/Tk - это графическое приложение для управления запланированными задачами в Unix-подобных системах. Программа позволяет легко создавать, редактировать и удалять задачи cron через удобный графический интерфейс без необходимости ручного редактирования crontab.

## Основные возможности

- **Поддержка различных скриптов**: запуск bash, python и tcl скриптов
- **Понятный формат времени**: поддержка человеческого формата времени на русском языке и стандартного cron-синтаксиса
- **Запуск GUI приложений**: корректная настройка переменных окружения для запуска графических приложений
- **Тестирование скриптов**: возможность тестового запуска скрипта перед добавлением в расписание
- **Журналирование**: автоматическое создание лог-файлов для каждой задачи
- **Мониторинг**: отслеживание времени последнего запуска задач
- **Автоматические обертки**: создание wrapper-скриптов для корректного запуска задач
- **Центрированное окно**: автоматическое позиционирование окна по центру экрана при запуске

## Зависимости

- **Tcl/Tk**: версия 8.5 или выше
- **Bash**: для выполнения wrapper-скриптов
- **Python** (опционально): если планируется запускать Python-скрипты
- **Crontab**: доступ к утилите crontab для управления задачами

### Установка зависимостей

**Debian/Ubuntu**:
```bash
sudo apt-get install tcl tk python3
```

**Fedora/RHEL/CentOS**:
```bash
sudo dnf install tcl tk python3
```

## Установка

1. Скачайте скрипт `GuiCronManager_09.tcl`
2. Сделайте его исполняемым:
   ```bash
   chmod +x GuiCronManager_09.tcl
   ```

## Запуск

```bash
./GuiCronManager_09.tcl
```

или

```bash
wish ./GuiCronManager_09.tcl
```

## Использование

### Добавление задачи

1. Нажмите кнопку "Обзор" и выберите скрипт для запуска
2. Введите название задачи (автоматически заполняется именем файла)
3. Введите время выполнения в человекочитаемом формате
4. Включите опцию "GUI приложение", если скрипт запускает графический интерфейс
5. Нажмите "Добавить задачу"

### Форматы времени

#### Человеческий формат:
- "каждый день в 9:00"
- "каждый день в 09:30"
- "каждый понедельник в 14:30"
- "каждый вторник в 08:00"
- "каждые 30 минут"
- "каждые 2 часа"
- "каждую минуту"

#### Простой формат дней недели:
- "суббота 9:30"
- "понедельник 14:00"
- "среда 12:45"

#### Точная дата и время:
- "15.03.2024 14:30" (один раз)
- "01.01.2025 00:00" (Новый год)

#### Стандартный cron (для продвинутых):
- "0 9 * * *" (каждый день в 9:00)
- "*/30 * * * *" (каждые 30 минут)
- "0 14 * * 1" (понедельник в 14:00)

### Удаление задачи

1. Выберите задачу в списке
2. Нажмите кнопку "Удалить"

### Просмотр деталей задачи

Двойной клик по задаче в списке открывает окно с подробной информацией:
- Полный путь к скрипту
- Формат времени
- Выражение cron
- Статус
- Время последнего запуска
- Последние записи лог-файла (если доступны)

### Тестирование скрипта

1. Выберите скрипт
2. Нажмите кнопку "Тест запуска"
3. Результат выполнения отобразится в логе программы

## Технические детали

### Хранение конфигурации

Программа создает директорию `exec_log` в каталоге скрипта и хранит там все файлы:

```
каталог_скрипта/
  GuiCronManager_09.tcl
  exec_log/
    cron_manager_tasks.txt      # Конфигурация задач
    cron_manager_имя_задачи.log # Логи выполнения
    cron_manager_имя_задачи_wrapper.sh # Wrapper-скрипты
    cron_manager_имя_задачи_lastrun.txt # Время последнего запуска
```

Формат хранения задач в файле `exec_log/cron_manager_tasks.txt`:
```
название|путь_к_скрипту|формат_времени|cron_выражение|is_gui|статус|последний_запуск
```

### Логи выполнения

Для каждой задачи создается отдельный лог-файл:
```
exec_log/cron_manager_имя_задачи.log
```

### Wrapper-скрипты

Для каждой задачи автоматически создается bash-скрипт обертка:
```
exec_log/cron_manager_имя_задачи_wrapper.sh
```

Этот скрипт устанавливает необходимые переменные окружения, записывает информацию в лог и запускает целевой скрипт.

## Особенности запуска GUI приложений

Для корректного запуска GUI приложений из cron, wrapper-скрипт устанавливает следующие переменные окружения:
- `DISPLAY=:0`
- `XAUTHORITY`
- `DBUS_SESSION_BUS_ADDRESS`
- `XDG_RUNTIME_DIR`
- `HOME`

Это позволяет графическим приложениям корректно отображаться на экране пользователя.

## Лицензия

GPL v. 3.0

